<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mawjat Analytics | Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Cairo', sans-serif; background-color: #f4f7fa; }
        .glass-effect { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); }
        .navy-gradient { background: linear-gradient(135deg, #001a4d 0%, #002366 100%); }
    </style>
</head>
<body class="antialiased min-h-screen pb-12">

    <header class="navy-gradient text-white p-6 shadow-xl mb-8">
        <div class="max-w-5xl mx-auto flex justify-between items-center">
            <div>
                <h1 class="text-3xl font-black tracking-tighter italic">MAWJAT <span class="text-blue-400 font-light">OFFICIAL</span></h1>
                <p class="text-[10px] opacity-70 font-bold uppercase tracking-widest">Enterprise Analytics System v2.0</p>
            </div>
            <div class="flex items-center gap-3 bg-white/10 px-4 py-2 rounded-2xl border border-white/20">
                <div class="w-2 h-2 rounded-full bg-green-400 animate-pulse"></div>
                <span class="text-xs font-bold uppercase">System Active</span>
            </div>
        </div>
    </header>

    <main class="max-w-5xl mx-auto px-4 space-y-6">
        
        <section class="bg-slate-900 rounded-[2.5rem] p-8 shadow-2xl border border-slate-800 text-white">
            <div class="flex items-center gap-4 mb-6">
                <div class="p-3 bg-blue-600 rounded-2xl shadow-lg shadow-blue-500/20">ğŸ”‘</div>
                <div>
                    <h3 class="font-black text-xl">ØªØ£Ù…ÙŠÙ† Ø§Ù„ÙˆØµÙˆÙ„ (API Security)</h3>
                    <p class="text-[10px] text-slate-400 uppercase font-bold italic">Required for Authentication</p>
                </div>
            </div>
            <div class="flex flex-col md:flex-row gap-3">
                <input id="key_input" type="password" placeholder="Ø£Ø¯Ø®Ù„ Ù…ÙØªØ§Ø­ Ø§Ù„Ù€ API Ø§Ù„Ø®Ø§Øµ Ø¨Ù…Ù†Ø´Ø£ØªÙƒ" 
                       class="flex-1 p-4 bg-slate-800 border-none rounded-2xl text-center font-bold text-blue-400 outline-none focus:ring-2 ring-blue-600 transition-all">
                <button onclick="saveKey()" class="bg-blue-600 hover:bg-blue-500 px-10 py-4 rounded-2xl font-black transition-all shadow-lg active:scale-95">Ø­ÙØ¸ Ø§Ù„Ù…ÙØªØ§Ø­</button>
            </div>
            <p id="key_status" class="text-[10px] mt-4 text-slate-500 font-bold italic pr-2"></p>
        </section>

        <div class="grid md:grid-cols-3 gap-6">
            <section class="md:col-span-2 bg-white rounded-[2.5rem] p-10 shadow-sm border border-gray-100 relative overflow-hidden">
                <div class="absolute top-0 left-0 w-2 h-full bg-blue-600"></div>
                <h3 class="font-black text-slate-800 text-2xl mb-8 flex items-center gap-3">
                    ğŸš€ Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ ØªÙ‚ÙŠÙŠÙ… Ø¬Ø¯ÙŠØ¯
                </h3>
                <div class="grid md:grid-cols-2 gap-4">
                    <div class="space-y-2">
                        <label class="text-[10px] font-black text-slate-400 uppercase pr-4">Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
                        <input id="name" type="text" placeholder="Ù…Ø«Ø§Ù„: Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯" 
                               class="w-full p-4 bg-gray-50 border border-gray-100 rounded-2xl outline-none font-bold text-right focus:border-blue-500 transition-all">
                    </div>
                    <div class="space-y-2">
                        <label class="text-[10px] font-black text-slate-400 uppercase pr-4">Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„</label>
                        <input id="phone" type="tel" placeholder="05xxxxxxxx" 
                               class="w-full p-4 bg-gray-50 border border-gray-100 rounded-2xl outline-none font-bold text-center focus:border-blue-500 transition-all">
                    </div>
                </div>
                <div class="mt-6 space-y-2">
                    <label class="text-[10px] font-black text-slate-400 uppercase pr-4">Ø§Ø®ØªØ± Ø§Ù„ÙØ±Ø¹</label>
                    <select id="branch" class="w-full p-4 bg-gray-50 border border-gray-100 rounded-2xl font-bold outline-none text-center cursor-pointer hover:bg-gray-100 transition-all">
                        <option value="Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ">Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</option>
                        <option value="ÙØ±Ø¹ Ø§Ù„ØªØ­Ù„ÙŠØ©">ÙØ±Ø¹ Ø§Ù„ØªØ­Ù„ÙŠØ©</option>
                        <option value="ÙØ±Ø¹ Ø§Ù„Ø¯Ù…Ø§Ù…">ÙØ±Ø¹ Ø§Ù„Ø¯Ù…Ø§Ù…</option>
                    </select>
                </div>
                <button onclick="sendOfficialEval()" class="w-full bg-slate-900 text-white p-6 rounded-[2rem] font-black text-xl mt-10 hover:bg-black shadow-xl hover:-translate-y-1 transition-all active:scale-95">
                    Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ âœ¨
                </button>
            </section>

            <aside class="space-y-6">
                <div class="bg-white p-8 rounded-[2.5rem] shadow-sm border border-gray-100 text-center relative overflow-hidden">
                    <div class="absolute top-0 right-0 p-2 opacity-5">ğŸ“ˆ</div>
                    <p class="text-[10px] font-black text-gray-400 uppercase tracking-tighter mb-2">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ù…Ø±Ø³Ù„Ø©</p>
                    <h2 class="text-5xl font-black text-slate-800">{{total}}</h2>
                    <div class="mt-4 text-[10px] text-green-500 font-bold">ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ø­Ø¸ÙŠ</div>
                </div>

                <a href="/reports" class="flex items-center justify-between bg-blue-50 p-6 rounded-[2rem] border border-blue-100 group hover:bg-blue-600 transition-all">
                    <span class="font-black text-blue-600 group-hover:text-white transition-colors">ğŸ“Š Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</span>
                    <span class="text-xl group-hover:translate-x-[-5px] transition-transform">â¬…ï¸</span>
                </a>

                <div class="bg-gray-50 p-6 rounded-[2rem] border border-dashed border-gray-200">
                    <p class="text-[10px] font-bold text-gray-400 leading-relaxed text-center italic">
                        "Ù†Ø¸Ø§Ù… Ù…ÙˆØ¬Ø© ÙŠØ¶Ù…Ù† Ù„Ùƒ ØªØ­Ø³ÙŠÙ† Ø³Ù…Ø¹ØªÙƒ Ø§Ù„Ø±Ù‚Ù…ÙŠØ© Ø¹Ø¨Ø± Ø£ØªÙ…ØªØ© Ø·Ù„Ø¨Ø§Øª Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø¨Ø¯Ù‚Ø©"
                    </p>
                </div>
            </aside>
        </div>
    </main>

    <script>
        // Ø¯Ø§Ù„Ø© Ø­ÙØ¸ Ø§Ù„Ù…ÙØªØ§Ø­ ÙÙŠ Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…ØªØµÙØ­ Ù„Ù„Ø£Ù…Ø§Ù†
        const saveKey = () => {
            const key = document.getElementById('key_input').value;
            if(key) {
                localStorage.setItem('mawjat_api_key', key);
                document.getElementById('key_status').innerText = "âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…ÙØªØ§Ø­ ÙˆØªØ´ÙÙŠØ±Ù‡ Ù…Ø­Ù„ÙŠØ§Ù‹";
                alert('ØªÙ… Ø­ÙØ¸ Ù…ÙØªØ§Ø­ Ø§Ù„Ø£Ù…Ø§Ù† Ø¨Ù†Ø¬Ø§Ø­');
            }
        };

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙØªØ§Ø­ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
        window.onload = () => {
            const savedKey = localStorage.getItem('mawjat_api_key');
            if(savedKey) {
                document.getElementById('key_input').value = savedKey;
                document.getElementById('key_status').innerText = "âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ù…Ø­ÙÙˆØ¸ Ø³Ø§Ø¨Ù‚Ø§Ù‹";
            }
        };

        async function sendOfficialEval() {
            const n = document.getElementById('name').value;
            const p = document.getElementById('phone').value;
            const b = document.getElementById('branch').value;
            const key = localStorage.getItem('mawjat_api_key');

            if(!p || !n || !key) {
                return alert('âš ï¸ ØªÙ†Ø¨ÙŠÙ‡: ÙŠØ±Ø¬Ù‰ Ø¥ÙƒÙ…Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙˆØ§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø­ÙØ¸ Ù…ÙØªØ§Ø­ Ø§Ù„Ù€ API Ø£ÙˆÙ„Ø§Ù‹');
            }

            try {
                const res = await fetch('/api/send', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'x-api-key': key // Ø§Ù„Ø£Ù…Ø§Ù† Ø¹Ø¨Ø± Ø§Ù„Ù€ Headers
                    },
                    body: JSON.stringify({phone: p, name: n, branch: b})
                });

                if(res.ok) {
                    alert('âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø¨Ù†Ø¬Ø§Ø­ Ù„Ù„Ø¹Ù…ÙŠÙ„');
                    document.getElementById('name').value = '';
                    document.getElementById('phone').value = '';
                } else {
                    const errData = await res.json();
                    alert('âŒ ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: ' + (errData.error || 'ØªØ£ÙƒØ¯ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ù…ÙØªØ§Ø­'));
                }
            } catch (e) {
                alert('âŒ Ø®Ø·Ø£: ØªØ¹Ø°Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±. ØªØ£ÙƒØ¯ Ù…Ù† ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙˆØ¹Ù…Ù„ Ø§Ù„Ù€ Push');
            }
        }
    </script>
</body>
</html>